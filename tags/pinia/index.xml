<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Pinia on Jérémie Litzler</title><link>https://jeremielitzLer.fr/tags/pinia/</link><description>Recent content in Pinia on Jérémie Litzler</description><generator>Hugo -- gohugo.io</generator><language>fr-fr</language><lastBuildDate>Mon, 04 Mar 2024 00:00:00 +0000</lastBuildDate><atom:link href="https://jeremielitzLer.fr/tags/pinia/index.xml" rel="self" type="application/rss+xml"/><item><title>Utiliser Pinia dans un intercepteur de navigation</title><link>https://jeremielitzLer.fr/post/2024-03/utiliser-pinia-dans-un-intercepteur-de-navigation/</link><pubDate>Mon, 04 Mar 2024 00:00:00 +0000</pubDate><guid>https://jeremielitzLer.fr/post/2024-03/utiliser-pinia-dans-un-intercepteur-de-navigation/</guid><description>&lt;img src="https://jeremielitzLer.fr/post/2024-03/utiliser-pinia-dans-un-intercepteur-de-navigation/images/2024-03-01-pinia-image-from.jpg" alt="Featured image of post Utiliser Pinia dans un intercepteur de navigation" />&lt;p>Si vous construisez une application de taille moyenne, vous finirez par utiliser des gardes de navigation pour parcourir les différentes pages de votre application.&lt;/p>
&lt;p>Le cas d’utilisation classique : vous souhaitez vérifier qu’un objet existe bien avant de charger ses détails (par exemple sur l’intercepteur &lt;code>beforeEnter&lt;/code>).&lt;/p>
&lt;p>Maintenant, si vous construisez l’application avec Vue 3 et Pinia, c’est en interrogeant un magasin que vous lisez cet objet.&lt;/p>
&lt;p>Cependant, l’application ne charge pas Pinia avant l’appel &lt;code>mount&lt;/code> et vous chargez le routeur avant cela…&lt;/p>
&lt;p>Par conséquent, Pinia lancera une erreur &lt;em>« getActivePinia() » a été appelé mais il n’y avait pas de Pinia actif. Essayez-vous d’utiliser un magasin avant d’appeler « app.use(pinia) » ? Consultez &lt;a href="https://pinia.vuejs.org/core-concepts/outside-component-usage.html">https://pinia.vuejs.org/core-concepts/outside-component-usage.html&lt;/a> pour obtenir de l’aide. Cela échouera en production.&lt;/em>&lt;/p>
&lt;p>Quelle est la solution ? J’ai suivi les étapes de &lt;a href="https://stackoverflow.com/a/70714477">cette réponse Stackoverflow&lt;/a>.&lt;/p>
&lt;ol>
&lt;li>Créez un fichier &lt;code>pinia.ts&lt;/code> pour instancier Pinia. Placez-le dans le même endroit que vous avez mis vos magasins.&lt;/li>
&lt;li>Importez-le et appelez &lt;code>use&lt;/code> sur l’instance d’application dans &lt;code>main.ts&lt;/code>&lt;/li>
&lt;li>Importez-le aussi dans &lt;code>src/router/index.ts&lt;/code> et fournissez-le à votre instance de magasin qui vous permet de lire l’objet cible : &lt;code>const store = useStore( pinia )&lt;/code>&lt;/li>
&lt;/ol>
&lt;p>La signature du store &lt;code>useStory&lt;/code> n’a pas besoin d’être modifiée. Fournir l’instance &lt;code>pinia&lt;/code> à &lt;code>useStore()&lt;/code> est suffisant pour que cela fonctionne.&lt;/p></description></item></channel></rss>